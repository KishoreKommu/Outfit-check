{% extends 'base.html' %}
{% block title %}Dashboard | Outfit Check{% endblock %}

{% block content %}
<div class="container-content">
  <div class="card mx-auto text-white"
    style="max-width: 1000px; background-color: rgba(30, 30, 30, 0.85); animation: fadeInUp 1s;">
    <h2 class="mb-4 text-center">👤 Welcome, {{ request.user.username }}</h2>

    {% if outfits %}
    <div class="row">
      {% for outfit in outfits %}
      <div class="col-md-4 mb-4">
        <div class="card h-100 shadow-sm" style="background-color: rgba(255, 255, 255, 0.07); border: none;">
          <img src="{{ outfit.image.url }}" class="card-img-top" alt="Outfit Image"
            style="max-height: 300px; object-fit: cover;">
          <div class="card-body text-white">
            <p class="card-text"><strong>Description:</strong> {{ outfit.description }}</p>

            <a href="{% url 'outfit_result' outfit.id %}" class="btn btn-outline-success btn-sm w-100 mb-2">🎯 Get
              Result</a>

            {% if outfit.rating %}
            <p class="card-text"><strong>Rating:</strong> {{ outfit.rating }}</p>
            <p class="card-text"><strong>Feedback:</strong> {{ outfit.feedback }}</p>
            {% else %}
            <p class="text-muted">No rating generated yet.</p>
            {% endif %}

            <form method="post" action="{% url 'delete_outfit' outfit.id %}"
              onsubmit="return confirm('Delete this outfit?');">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger btn-sm w-100">Delete</button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-white-50 text-center">You haven’t uploaded any outfits yet.</p>
    {% endif %}

    <div class="text-center mt-4">
      <a href="{% url 'upload_outfit' %}" class="btn btn-custom">➕ Upload New Outfit</a>
    </div>

    <!-- Compact Outfit Gallery Below -->
    <hr class="my-5 border-light">
    <h4 class="text-center mb-4">🖼️ Your Outfit Gallery</h4>
    <div class="row">
      {% for outfit in outfits %}
      <div class="col-md-3 col-sm-4 col-6 mb-4">
        <div class="card shadow-sm" style="background-color: rgba(255,255,255,0.05); border: none;">
          <img src="{{ outfit.image.url }}" alt="Outfit Image" class="card-img-top"
            style="height: 160px; object-fit: cover; border-radius: 8px 8px 0 0;">
          <div class="card-body p-2 text-white text-center">
            <small class="d-block mb-2">📅 {{ outfit.uploaded_at|date:"M d, Y" }}</small>
            <form method="POST" action="{% url 'delete_outfit' outfit.id %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger btn-sm btn-block w-100">Delete</button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <hr class="my-5 border-light">

    <h4 class="text-center mb-3">💡 Fashion Tips</h4>
    <ul class="list-group">
      <li class="list-group-item bg-transparent text-white border-light">Stick to a color palette that complements your
        skin tone.</li>
      <li class="list-group-item bg-transparent text-white border-light">Invest in well-fitted basics that never go out
        of style.</li>
      <li class="list-group-item bg-transparent text-white border-light">Layer smartly — mix textures like denim,
        cotton, and leather.</li>
    </ul>
  </div>
</div>

<style>
  .btn-custom {
    background: linear-gradient(to right, #ff7e5f, #feb47b);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    transition: transform 0.3s ease;
  }

  .btn-custom:hover {
    transform: scale(1.05);
  }

  .card .card-body p {
    color: #f1f1f1;
  }

  .list-group-item {
    backdrop-filter: blur(4px);
  }

  .card-img-top {
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
  }
</style>
{% endblock %}
